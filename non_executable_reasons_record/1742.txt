3.6
An error occurred while executing the following cell:
------------------
import warnings
warnings.filterwarnings('ignore')
import time
import numpy as np
import mnist
from common import sigmoid, gradient_sigmoid, softmax, cross_entropy_error_batch

#
# Hyper parameters
#
# íˆë“ ë ˆì´ì–´ ë‰´ëŸ° ìˆ˜ (ex: 50, 100)
HIDDEN_LAYER_SIZE = 50
# ì •ê·œë¶„í¬ ë‚œìˆ˜ë¡œ ìƒì„±ë  ì´ˆê¸° ê°€ì¤‘ì¹˜ì˜ í‘œì¤€í¸ì°¨
WEIGHT_INIT_STD = 0.01
# í•™ìŠµì— ì‚¬ìš©í•  ë¯¸ë‹ˆë°°ì¹˜ì˜ í¬ê¸°
BATCH_SIZE = 100

#
# Main logic
#
MNIST = mnist.load()
TRAIN_IMG = MNIST['train_img']
TRAIN_LABEL = MNIST['train_label']

# ê° ë ˆì´ì–´ì˜ ë‰´ëŸ° ìˆ˜
layer0_size = TRAIN_IMG.shape[-1]
layer1_size = HIDDEN_LAYER_SIZE
layer2_size = TRAIN_LABEL.shape[-1]

# ëœë¤ìœ¼ë¡œ ì›¨ì´íŠ¸ í–‰ë ¬ê³¼ ê°€ì¤‘ì¹˜ ë²¡í„° ì´ˆê¸°í™”
parameters = [
    # w0
    WEIGHT_INIT_STD * np.random.randn(layer0_size, layer1_size), 
    # b0
    np.zeros(layer1_size),
    # w1
    WEIGHT_INIT_STD * np.random.randn(layer1_size, layer2_size),
    # b1
    np.zeros(layer2_size),
]

# ë¯¸ë‹ˆë°°ì¹˜: íŠ¸ë ˆì¸ì…‹ì—ì„œ ê·¸ë˜ë””ì–¸íŠ¸ ê³„ì‚°ìš©ìœ¼ë¡œ ì“¸ ë°ì´í„° Nê°œ ì„ì˜ì¶”ì¶œ
indices = np.random.choice(TRAIN_IMG.shape[0], BATCH_SIZE)
BATCH_IMG, BATCH_LABEL = TRAIN_IMG[indices], TRAIN_LABEL[indices]

def predict(w0, b0, w1, b1):
    a0 = BATCH_IMG @ w0 + b0
    z0 = sigmoid(a0)
    a1 = z0 @ w1 + b1
    z1 = softmax(a1)
    return [a0, z0, a1, z1]

def grad_analytic(parameters):
    w1 = parameters[2]
    a0, z0, _, expected = predict(*parameters)

    # Backward propagation
    dz1 = (expected - BATCH_LABEL)/BATCH_SIZE
    dw1 = z0.T @ dz1
    db1 = dz1.sum(axis=0)

    dz0 = gradient_sigmoid(a0) * (dz1 @ w1.T)
    dw0 = BATCH_IMG.T @ dz0
    db0 = dz0.sum(axis=0)
    return [dw0, db0, dw1, db1]

def grad_numerical(parameters, h=1E-4):
    def loss_function(*arguments):
        expected = predict(*arguments)[-1]
        return cross_entropy_error_batch(expected, BATCH_LABEL)
    def grad(param):
        shape = param.shape
        gradient = np.empty(shape)
        for j in np.ndindex(shape):
            orig = param[j]
            param[j] = orig + h
            y2 = loss_function(*parameters)
            param[j] = orig - h
            y1 = loss_function(*parameters)
            param[j] = orig
            gradient[j] = (y2 - y1)/(2*h)
        return gradient
    return [grad(param) for param in parameters]

print('\x1b[31m1. ê³„ì‚°ì‹œê°„ ë¹„êµ\x1b[0m')
# í•´ì„ì ìœ¼ë¡œ ê·¸ë˜ë””ì–¸íŠ¸ ê³„ì‚°
t0 = time.time()
analytic = grad_analytic(parameters)
t1 = time.time()
print(f'í•´ì„ì ìœ¼ë¡œ ê³„ì‚°í•˜ëŠ”ë°ì— ë“  ì‹œê°„ : {t1 - t0:.04}ì´ˆ')
# ìˆ˜ì¹˜ì ìœ¼ë¡œ ê·¸ë˜ë””ì–¸íŠ¸ ê³„ì‚°
t0 = time.time()
numerical = grad_numerical(parameters)
t1 = time.time()
print(f'ìˆ˜ì¹˜ì ìœ¼ë¡œ ê³„ì‚°í•˜ëŠ”ë°ì— ë“  ì‹œê°„ : {t1 - t0:.04}ì´ˆ\n\n')

# í–‰ë ¬ ì¶œë ¥
names = ['âˆ‡W0', 'âˆ‡B0', 'âˆ‡W1', 'âˆ‡B1']
np.set_printoptions(suppress=True, precision=5, threshold=5)
print('\x1b[31m2. ê·¸ë˜ë””ì–¸íŠ¸ê°’ ìƒê¹€ìƒˆ\x1b[0m')
for name, mat in zip(names, analytic): print(f'  {name}\n{mat}\n')

# í•´ì„ì ìœ¼ë¡œ ê³„ì‚°í•œê²ƒê³¼, ìˆ˜ì¹˜ì ìœ¼ë¡œ ê³„ì‚°í•œê²ƒ ë¹„êµ
print('''
\x1b[31m3. í•´ì„ì ìœ¼ë¡œ êµ¬í•œ ê·¸ë˜ë””ì–¸íŠ¸ì™€, ìˆ˜ì¹˜ì ìœ¼ë¡œ êµ¬í•œ ê·¸ë˜ë””ì–¸íŠ¸ê°€ ì–¼ë§ˆë‚˜ ë¹„ìŠ·í• ê¹Œ?\x1b[0m
í•­ëª©\tí–‰ë ¬ ì›ì†Œ ì´ì°¨í‰ê· \tìˆ˜ì¹˜ì ìœ¼ë¡œ ê³„ì‚°í•œê²ƒê³¼ì˜ ì˜¤ì°¨
------------------------------------------------------------''')
for analytic, numerical, name in zip(analytic, numerical, names):
    mean = np.sqrt((analytic**2).mean())
    error = np.sqrt(((analytic - numerical)**2).mean())

    print(f'{name}\t{mean:18.02}\t{error:28.02}')
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mPermissionError[0m                           Traceback (most recent call last)
[0;32m<ipython-input-1-2a371c93ce37>[0m in [0;36m<module>[0;34m[0m
[1;32m     19[0m [0;31m# Main logic[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[1;32m     20[0m [0;31m#[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[0;32m---> 21[0;31m [0mMNIST[0m [0;34m=[0m [0mmnist[0m[0;34m.[0m[0mload[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     22[0m [0mTRAIN_IMG[0m [0;34m=[0m [0mMNIST[0m[0;34m[[0m[0;34m'train_img'[0m[0;34m][0m[0;34m[0m[0;34m[0m[0m
[1;32m     23[0m [0mTRAIN_LABEL[0m [0;34m=[0m [0mMNIST[0m[0;34m[[0m[0;34m'train_label'[0m[0;34m][0m[0;34m[0m[0;34m[0m[0m

[0;32m/mnt/fit-Knowledgezoo/jupyternotebooks/simnalamburt@snucse/Deep Learning from Scratch/mnist/__init__.py[0m in [0;36mload[0;34m(normalize, flatten, one_hot_label)[0m
[1;32m     84[0m [0;34m[0m[0m
[1;32m     85[0m     [0;31m# MNIST ë°ì´í„°ë¥¼ ë¡œë“œí•œë‹¤.[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[0;32m---> 86[0;31m     [0mdataset[0m [0;34m=[0m [0mdownload[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     87[0m [0;34m[0m[0m
[1;32m     88[0m     [0;31m# [0.0, 1.0] êµ¬ê°„ ì•ˆì— ë“¤ì–´ê°€ë„ë¡ ì´ë¯¸ì§€ë¥¼ ì •ê·œí™”í•œë‹¤.[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m

[0;32m/mnt/fit-Knowledgezoo/jupyternotebooks/simnalamburt@snucse/Deep Learning from Scratch/mnist/__init__.py[0m in [0;36mdownload[0;34m()[0m
[1;32m     39[0m         [0;31m# ì´ë¯¸ ë‹¤ìš´ë°›ì€ íŒŒì¼ì¼ê²½ìš° ìƒëµí•œë‹¤.[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[1;32m     40[0m         [0;32mif[0m [0;32mnot[0m [0mos[0m[0;34m.[0m[0mpath[0m[0;34m.[0m[0mexists[0m[0;34m([0m[0mpath[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m---> 41[0;31m             [0mrequest[0m[0;34m.[0m[0murlretrieve[0m[0;34m([0m[0mURL_BASE[0m [0;34m+[0m [0mfile_name[0m[0;34m,[0m [0mpath[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     42[0m [0;34m[0m[0m
[1;32m     43[0m     [0;32mdef[0m [0mload[0m[0;34m([0m[0mcallback[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/miniconda3/envs/Osiris_py36/lib/python3.6/urllib/request.py[0m in [0;36murlretrieve[0;34m(url, filename, reporthook, data)[0m
[1;32m    256[0m         [0;31m# Handle temporary file setup.[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[1;32m    257[0m         [0;32mif[0m [0mfilename[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 258[0;31m             [0mtfp[0m [0;34m=[0m [0mopen[0m[0;34m([0m[0mfilename[0m[0;34m,[0m [0;34m'wb'[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    259[0m         [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    260[0m             [0mtfp[0m [0;34m=[0m [0mtempfile[0m[0;34m.[0m[0mNamedTemporaryFile[0m[0;34m([0m[0mdelete[0m[0;34m=[0m[0;32mFalse[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;31mPermissionError[0m: [Errno 13] Permission denied: '/mnt/fit-Knowledgezoo/jupyternotebooks/simnalamburt@snucse/Deep Learning from Scratch/mnist/train-images-idx3-ubyte.gz'
PermissionError: [Errno 13] Permission denied: '/mnt/fit-Knowledgezoo/jupyternotebooks/simnalamburt@snucse/Deep Learning from Scratch/mnist/train-images-idx3-ubyte.gz'

Executability                            : False
