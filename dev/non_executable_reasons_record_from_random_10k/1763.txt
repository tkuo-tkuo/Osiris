3.5
An error occurred while executing the following cell:
------------------
import warnings
warnings.filterwarnings('ignore')
# Kerasã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import keras

# MINISTã®ãƒ‡ãƒ¼ã‚¿ã®ä»–ã€å¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
from keras.datasets import mnist
from keras.models import Sequential
from keras.layers.core import Dense, Dropout, Activation
from keras.optimizers import RMSprop
from keras.callbacks import EarlyStopping, CSVLogger
%matplotlib inline
import matplotlib.pyplot as plt
# SVGã®è¡¨ç¤ºã«å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
from IPython.display import SVG
from keras.utils.vis_utils import model_to_dot

# ãƒãƒƒãƒã‚µã‚¤ã‚ºã€ã‚¯ãƒ©ã‚¹æ•°ã€ã‚¨ãƒãƒƒã‚¯æ•°ã‚’å®šç¾©
batch_size = 128
num_classes = 10
epochs = 20

# MNISTãƒ‡ãƒ¼ã‚¿ã‚’èª­è¾¼
(x_train, y_train), (x_test, y_test) = mnist.load_data()

# MNISTãƒ‡ãƒ¼ã‚¿ã®ã†ã¡10æšã ã‘è¡¨ç¤º
for i in range(10):
    plt.subplot(2, 5, i+1)
    plt.title("M_%d" % i)
    plt.axis("off")
    plt.imshow(x_train[i].reshape(28, 28), cmap=None)
plt.show()

# ç”»åƒã‚µã‚¤ã‚ºã‚’æ­£è¦åŒ–
x_train = x_train.reshape(60000, 784).astype('float32')
x_test = x_test.reshape(10000, 784).astype('float32')
x_train /= 255
x_test /= 255
y_train = keras.utils.to_categorical(y_train, num_classes)
y_test = keras.utils.to_categorical(y_test, num_classes)

# ç¢ºèªã®ãŸã‚ã«è¡¨ç¤º
print(x_train.shape)
print(y_train.shape)
print(x_test.shape)
print(y_test.shape)

# ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆ
model = Sequential()
model.add(Dense(512, input_shape=(784, )))
model.add(Activation('relu'))
model.add(Dropout(0.2))
model.add(Dense(512))
model.add(Activation('relu'))
model.add(Dropout(0.2))
model.add(Dense(10))
model.add(Activation('softmax'))

# ã‚µãƒãƒªãƒ¼ã‚’å‡ºåŠ›
model.summary()

# SVGå½¢å¼ã§ãƒ¢ãƒ‡ãƒ«ã‚’è¡¨ç¤º
SVG(model_to_dot(model, show_shapes=True).create(prog='dot', format='svg'))

# ãƒ¢ãƒ‡ãƒ«ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
model.compile(loss='categorical_crossentropy',
              optimizer=RMSprop(),
              metrics=['accuracy'])

es = EarlyStopping(monitor='val_loss', patience=2)
hist = model.fit(x_train, y_train,
                 batch_size=batch_size,
                 epochs=epochs,
                 verbose=1,
                 validation_split=0.1,
                 callbacks=[es])

# å­¦ç¿’ã‚’å®Ÿè¡Œ
score = model.evaluate(x_test, y_test, verbose=0)
print('test loss:', score[0])
print('test acc:', score[1])


# å­¦ç¿’çµæœã‚’è¡¨ç¤º
loss = hist.history['loss']
val_loss = hist.history['val_loss']
epochs = len(loss)
plt.plot(range(epochs), loss, marker='.', label='loss(training data)')
plt.plot(range(epochs), val_loss, marker='.', label='val_loss(evaluationdata)')
plt.legend(loc='best')
plt.grid()
plt.xlabel('epoch')
plt.ylabel('loss')
plt.show()

#æ­£ç­”ç‡ã®è¡¨ç¤º
plt.plot(hist.history['acc'])
plt.plot(hist.history['val_acc'])
plt.title('model accuracy')
plt.ylabel('accuracy')
plt.xlabel('epoch')
plt.legend(['train', 'test'], loc='upper left')
plt.show()
plt.show()
#loss
plt.plot(hist.history['loss'])
plt.plot(hist.history['val_loss'])
plt.title('model loss')
plt.ylabel('loss')
plt.xlabel('epoch')
plt.legend(['train', 'test'], loc='upper left')
plt.show()
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mImportError[0m                               Traceback (most recent call last)
[0;32m<ipython-input-1-31aa836919f4>[0m in [0;36m<module>[0;34m()[0m
[1;32m      2[0m [0mwarnings[0m[0;34m.[0m[0mfilterwarnings[0m[0;34m([0m[0;34m'ignore'[0m[0;34m)[0m[0;34m[0m[0m
[1;32m      3[0m [0;31m# Kerasã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ[0m[0;34m[0m[0;34m[0m[0m
[0;32m----> 4[0;31m [0;32mimport[0m [0mkeras[0m[0;34m[0m[0m
[0m[1;32m      5[0m [0;34m[0m[0m
[1;32m      6[0m [0;31m# MINISTã®ãƒ‡ãƒ¼ã‚¿ã®ä»–ã€å¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ[0m[0;34m[0m[0;34m[0m[0m

[0;31mImportError[0m: No module named 'keras'
ImportError: No module named 'keras'

Executability                            : False
